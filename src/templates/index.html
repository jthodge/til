{% extends "til_base.html" %}

{% block title %}Taylor Hodge - TIL{% endblock %}

{% block extra_head %}
<link rel="alternate" type="application/atom+xml" title="Atom" href="/til/feed.atom" />
<link rel="stylesheet" href="/static/forms.css" />
{% endblock %}

{% block body %}
{% set til_count = sql("select count(*) from TIL", database="til")[0][0] %}

<h1>
    Today I learned
    {% with href="/til/feed.atom", title="Atom feed" %}
        {% include "components/feed_icon.html" %}
    {% endwith %}
</h1>
<p>
    Things I've learned and collected in
    <a href="https://github.com/jthodge/til">jthodge/til</a>.
</p>

<!-- <form action="/til/search">
  <p>
    <input type="search" name="q" placeholder="Search {{ til_count }} TILs">
    <input type="submit" value="Search" />
  </p>
</form> -->

<p><a href="/all">Browse all {{ til_count }} TILs</a></p>

<p>
    <strong>Browse by topic:</strong>
    {% for row in sql("select topic, count(*) as num_tils from til group by topic order by topic", database="til") %}
        <a title="{{ row.num_tils }} TIL{{ "s" if row.num_tils > 1 else "" }}" href="/{{ row.topic }}">{{ row.topic }}</a> {{ row.num_tils }}{% if not loop.last %} &middot;{% endif %}
    {% endfor %}
</p>

<p>
    <strong>Recently added:</strong>
    <ul>
        {% for row in sql("select * from til order by created_utc desc limit 5", database="til") %}
        <li>
            <a href="/{{ row.topic }}/{{ row.slug }}">{{ row.title }}</a>
        </li>
        {% endfor %}
    </ul>
</p>

{% endblock %}