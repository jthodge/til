{% extends "base.html" %}

{% set tils = sql("""
    select * from til where topic = :topic order by created_utc desc 
""", {"topic": topic}, database="til") %}

{% block title %}Taylor Hodge â€” TILs on {{ topic }}{% endblock %}

{% block body %}
{% import "macros.html" as macros %}

{% if not tils %}
    {{ raise_404("No TILs found") }}
{% endif %}

<h1>TILs on {{ topic }}{{ macros.simple_marginnote(tils|length ~ " total") }}</h1>

<p>
    {% with href="/tils/feed_by_topic.atom?topic={{ topic }}", title="Atom feed for {{ topic }}" %}
        {% include "components/feed_icon.html" %}
    {% endwith %}
    Atom feed for {{ topic }}{{ macros.sidenote("Subscribe to get notified of new " ~ topic ~ " TILs") }}
</p>

{% for til in tils %}
<h3>
    <a href="/{{ til.topic }}/{{ til.slug }}">{{ til.title }}</a>{{ macros.simple_marginnote(til.created[:10]) }}
</h3>
{% endfor %}

{{ macros.topic_suggestions(topic, 5) }}

{% include "partials/_discovery.html" %}

{% with show_all_link=true, show_home_link=true %}
    {% include "partials/_navigation.html" %}
{% endwith %}
{% endblock %}